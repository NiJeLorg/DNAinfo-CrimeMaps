{% extends 'apartment/baseNYC.html' %}
{% load staticfiles %}
{% load bootstrap_tags %}
{% load django_select2_tags %}

{% block title %}My First Apartment | DNAinfo{% endblock %}

{% block css_block %}
{% import_django_select2_css %}
<link rel="stylesheet" type="text/css" href="{% static 'apartment/css/leaflet.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'apartment/css/leaflet.draw.css' %}">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
{% endblock %}

{% block head_js_block %}
<meta property="fb:app_id" content="406014149589534" /> 
<meta property="og:type"   content="website" /> 
<meta property="og:url"    content="https://www.dnainfo.com/new-york/" /> 
<meta property="og:description" content="How rents compare." />
<meta property="og:title"  content="How rents compare." /> 
<meta property="og:image"  content="" />
<script type="text/javascript">
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '406014149589534',
      xfbml      : true,
      version    : 'v2.4'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
{% endblock %}

<!-- Content -->
{% block body_block %}
<div id="content" class="fadein">
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-8 col-sm-offset-2">
                <h2 class="resultsHeading">
                    Here's how much you'd pay to live in <span id="headingRegionName"></span> today:
                </h2>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-8 col-sm-offset-2">
                <div id="visContainer"></div>
            </div>
        </div>
        <div class="row marginBottom20">
            <div class="col-sm-8 col-sm-offset-2">
                <a class="methods" href="#" data-toggle="modal" data-target="#methodology">Methodology</a>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-8 col-sm-offset-2 bottomButtonGroupResults">
                <a id="letsGoAgain" class="btn btn-dna-primary" href="/my-first-apartment/" role="button">Let's Go Again!</a>
                <span class="pull-right">
                    <a id="showShareFB" class="btn btn-dna-facebook" href="#" role="button" onclick="#"><i class="fa fa-facebook-official fa-2x"></i></a>
                    <a id="showShareTwitter" class="btn btn-dna-twitter" href="#" role="button" onclick="#"><i class="fa fa-twitter fa-2x"></i></a>
                </span>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block modal_block %}   
  <div class="modal fade" id="methodology" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="xIcon"></span></button>
        </div>
        <div class="modal-body modalContent">
          <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
          </p>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block js_block %}
<script type="text/javascript">
    var allPaid = parseFloat("{{ NYCmyFirstApartmentObject.allPaid }}").toFixed(0);
    var withInflation = parseFloat("{{ NYCmyFirstApartmentObject.withInflation }}").toFixed(0);
    var today = parseFloat("{{ NYCmyFirstApartmentObject.today }}").toFixed(0);
    var bedrooms = parseInt("{{ NYCmyFirstApartmentObject.bedrooms }}");
    var todayType = "{{ NYCmyFirstApartmentObject.todayType }}".replace("&#39;", "'");
    var year = "{{ NYCmyFirstApartmentObject.year }}";
    var bitlyURL = "{{ bitlyURL.url }}";
    $( document ).ready(function() {
        if (todayType == "Citywide") {
            $("#headingRegionName").text("New York City");
        } else {
            $("#headingRegionName").text(todayType);            
        }
        
        window.setTimeout(function() { 
            drawBars.initialize();
        }, 1);

        // set up modal
        $('#methodology').modal('hide');

        // set up twitter and facebook URLs
        var app_id = '406014149589534';
        var fbcaption = "I paid $"+ drawBars.numberWithCommas(allPaid) +" to live in "+"{{ NYCmyFirstApartmentObject.whereMoved.name }}".replace("&#39;", "'") + " in "+ year +". Here's how rents compare now: "+ bitlyURL +" via https://www.facebook.com/DNAinfo/";
        var fblink = "https://visualizations.dnainfo.com/my-first-apartment/";
        var fbUrl = 'https://www.facebook.com/dialog/feed?app_id=' + app_id + '&display=popup&caption='+ encodeURIComponent(fbcaption) + '&link=' + encodeURIComponent(bitlyURL) + '&redirect_uri=' + encodeURIComponent(fblink);
        var fbOnclick = 'window.open("' + fbUrl + '","facebook-share-dialog","width=626,height=436");return false;';
        //$('#showShareFB').attr("href", fbUrl);
        $('#showShareFB').attr("onclick", fbOnclick);


        var twitterlink = bitlyURL;
        var via = 'DNAinfo';
        var twittercaption = "I paid $"+ drawBars.numberWithCommas(allPaid) +" to live in "+"{{ NYCmyFirstApartmentObject.whereMoved.name }}".replace("&#39;", "'") + " in "+ year +". Here's how rents compare now:";
        var twitterUrl = 'https://twitter.com/intent/tweet?url=' + encodeURIComponent(twitterlink) + '&via='+ encodeURIComponent(via) + '&text=' + encodeURIComponent(twittercaption);
        var twitterOnclick = 'window.open("' + twitterUrl + '","twitter-share-dialog","width=626,height=436");return false;';
        //$('#showShareTwitter').attr("href", twitterUrl);
        $('#showShareTwitter').attr("onclick", twitterOnclick);
    });

</script>   
{% import_django_select2_js %}
<script type="text/javascript" src="{% static 'apartment/js/leaflet.js' %}"></script>
<script type="text/javascript" src="{% static 'apartment/js/leaflet.draw.js' %}"></script>
<script type="text/javascript" src="{% static 'apartment/js/d3.min.js' %}"></script>
<script type="text/javascript" src="{% static 'apartment/js/controllers.js' %}"></script>
<script type="text/javascript" src="{% static 'apartment/js/ajax.js' %}"></script>
<script type="text/javascript" src="{% static 'apartment/js/map.js' %}"></script>
<script type="text/javascript" src="{% static 'apartment/js/bar.js' %}"></script>
{% endblock %}


